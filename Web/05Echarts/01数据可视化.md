## 数据可视化

- 数据可视化的主要目的:借助于图形化手段,清晰有效地传达与沟通的信息
- 数据可视化可以把数据从冰冷的数字转化成图形,揭示蕴含在数据中的规律和道理

#### 阶段目标：项目介绍

​	应对现在数据可视化的趋势，越来越多企业需要在很多场景(营销数据，生产数据，用户数据)下使用，可视化图表来展示体现数据，让数据更加直观，数据特点更加突出。我们引入 '立可得' 数据可视化项目。

​	该项目除了使用了基础的DIV+CSS布局，还引入了一些C3技术，还引入了各类图表的绘制，以及高级的地图数据可视化案例。主要功能有：饼状图、柱状图、线形图、地图 ...

#### 使用技术

完成该项目需要具备以下知识：

- div + css 布局
- flex 布局
- css3动画
- css3渐变
- css3边框图片
- 原生js  使用
- rem适配
- **echarts基础**

粗略代码统计：

- css  580行
- html  450行
- js 400行 (有效)



### eacharts-介绍

> ECharts，一个使用 JavaScript 实现的开源可视化库，可以流畅的运行在 PC 和移动设备上，兼容当前绝大部分浏览器（IE8/9/10/11，Chrome，Firefox，Safari等），底层依赖矢量图形库 [ZRender](https://github.com/ecomfe/zrender)，提供直观，交互丰富，可高度个性化定制的数据可视化图表。

大白话：

- 是一个JS插件
- 性能好可流畅运行PC与移动设备
- 兼容主流浏览器
- 提供很多常用图表，且可**定制**。
  - [折线图](https://echarts.apache.org/examples/zh/index.html#chart-type-line)、[柱状图](https://echarts.apache.org/examples/zh/index.html#chart-type-bar)、[散点图](https://www.echartsjs.com/zh/option.html#series-scatter)、[饼图](https://echarts.apache.org/examples/zh/index.html#chart-type-scatter)、[K线图](https://echarts.apache.org/examples/zh/index.html#chart-type-candlestick)

​          [ECharts官网](



### 03、Echarts-体验

```js
1、引入eacharts库,引入依赖
2、需要有一个可以展示eacharts图标的容器	div......
3、初始化eacharts
	var mychart=eacharts.init('装图标的容器')
4、开始写eacharts图标的配置项
	var option={...};
5、把配置项 设置给eacharts对象
```

官方教程：[快速上手](https://echarts.apache.org/handbook/zh/get-started/)

下载步骤：

- 下载echarts  ：

  在 https://www.jsdelivr.com/package/npm/echarts 选择 `dist/echarts.js`

  点进去，c t r l+a全选复制，

  把复制的内容新建 `echarts.js` 文件，进行存储。

  

  下载方法2：

  https://github.com/apache/echarts 点击，

在dist 下面，找到echarts.js

- 引入创建好的echarts .js文件
- 准备一个具备大小的DOM容器

```html
<div id="main" style="width: 600px;height:400px;"></div>
```

- ###### 初始化echarts

```js
var myChart = echarts.init(document.getElementById('main'));
```

- 指定配置项和数据(option)

```js
var option = {
    xAxis: {
        type: 'category',
        data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
    },
    yAxis: {
        type: 'value'
    },
    series: [{
      w  data: [820, 932, 901, 934, 1290, 1330, 1320],
        type: 'line'
    }]
};
```

- 将配置项设置给echarts实例对象

```js
myChart.setOption(option);
```

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>ECharts</title>
    <!-- 1、引入刚刚下载的 ECharts 文件 -->
    <script src="echarts.js"></script>
  </head>
  <body>
    <!-- 2、为 ECharts 准备一个定义了宽高的 DOM -->
    <div id="main" style="width: 600px;height:400px;"></div>
    <script type="text/javascript">
      // 3、基于准备好的dom，初始化echarts实例
      var myChart = echarts.init(document.getElementById('main'));

      // 4、指定图表的配置项和数据
      var option = {
        title: {
          text: 'ECharts 入门示例'
        },
        tooltip: {},
        legend: {
          data: ['销量']
        },
        xAxis: {
          data: ['衬衫', '羊毛衫', '雪纺衫', '裤子', '高跟鞋', '袜子']
        },
        yAxis: {},
        series: [
          {
            name: '销量',
            type: 'bar',
            data: [5, 20, 36, 10, 10, 20]
          }
        ]
      };

      // 5、使用刚指定的配置项和数据显示图表。
      myChart.setOption(option);
    </script>
  </body>
</html>
```

#### 自定义图标类型

即可自定义不同的图标样式

### 04-Echarts-基础配置

可查阅文档——API——配置项，查看具体每一项配置项的详解

![image-20221112151459234](asseits/image-20221112151459234.png)



> 需要了解的主要配置：`series` `xAxis` `yAxis` `grid` `tooltip` `title` `legend` `color` `toolbox` 



- series
  - 系列列表。每个系列通过 `type` 决定自己的图表类型
  - 大白话：图标数据，指定什么类型的图标，可以多个图表重叠。

- xAxis：直角坐标系 grid 中的 x 轴

  -  boundaryGap: 坐标轴两边留白策略 true，这时候刻度只是作为分隔线，标签和数据点都会在两个刻度之间的带(band)中间。

- yAxis：直角坐标系 grid 中的 y 轴

- grid：直角坐标系内绘图网格。 

- title：标题组件

- tooltip：提示框组件，即鼠标经过图标时提示的内容

- toolbox:工具栏，内置有[导出图片](https://echarts.apache.org/zh/option.html#toolbox.feature.saveAsImage)，[数据视图](https://echarts.apache.org/zh/option.html#toolbox.feature.dataView)，[动态类型切换](https://echarts.apache.org/zh/option.html#toolbox.feature.magicType)，[数据区域缩放](https://echarts.apache.org/zh/option.html#toolbox.feature.dataZoom)，[重置](https://echarts.apache.org/zh/option.html#toolbox.feature.reset)五个工具。

- legend：图例组件，即图例，什么颜色代表什么内容

- color：调色盘颜色列表，数组类型

  数据堆叠，同个类目轴上系列配置相同的`stack`值后 后一个系列的值会在前一个系列的值上相加。

演示代码：

```js
var option = {
            color: ['pink', 'blue', 'green', 'skyblue', 'red'],
            title: {
                text: '我的折线图'
            },
            tooltip: {
              // 触发提示： 经过坐标轴的时候
                trigger: 'axis'
            },
  					// 图例
            legend: {
                data: ['直播营销', '联盟广告', '视频广告', '直接访问']
            },
  					//坐标系网格
            grid: {
              	//当前网格距离整体容器左边3%
                left: '3%',
                right: '3%',
                bottom: '3%',
                // 当刻度标签溢出的时候，grid 区域是否包含坐标轴的刻度标签。如果为true，则显示刻度标签
                // 如果left right等设置为 0% 刻度标签就溢出了，此时决定是否显示刻度标签
                containLabel: true
            },
  					//工具栏 如刷新图标 导入图表为图片等等。。
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            xAxis: {
              	// category 种类的意思 如果设置为该值 表示x坐标系的划分，根据xAxis中的data数据划分
                type: 'category',
                // 坐标轴两边留白策略 true，这时候刻度只是作为分隔线，标签和数据点都会在两个刻度之间的带(band)中间。
                boundaryGap: false,
                data: ['星期一', '星期二', '周三', '周四', '周五', '周六', '周日']
            },
            yAxis: {
                type: 'value'
            },
  					//图表系列
            series: [
                {
                  	//name 系列名称  用于tooltip的显示，图例示选等
                    name: '直播营销',
                    // line 图表类型是线形图  type 选择图表的类型  bar 柱状图  pie 饼图
                    type: 'line',
                  	// y轴的数据 和x轴一一对应
                  	// 如120 对应星期一 132 对应星期二
                    data: [120, 132, 101, 134, 90, 230, 210],
                  	// stack 数据堆叠 后面值一样的数据 数据堆叠
                  	//       第二个数据显示的值 = 第一个的值 + 第二个的值
                    stack:'总量'
                },
                {
                    name: '联盟广告',
                    type: 'line',
                    data: [220, 182, 191, 234, 290, 330, 310],
                    stack:'总量',
                },
                {
                    name: '视频广告',
                    type: 'line',
										stack:'总量'
                    data: [150, 232, 201, 154, 190, 330, 410]
                },
                {
                    name: '直接访问',
                    type: 'line',
										stack:'总量',
                    data: [320, 332, 301, 334, 390, 330, 320]
                }
            ]
        };
```

#### 项目准备知识

1、获取对应属性，字符串

```js
 var obj = {
    name: "张三",
  };

  var val = obj.name;

  var val = "name";
  console.log(obj.name);
  console.log(obj[val]);
```

2、如何自动切换

```js
//点击切换
  //   var lis = document.getElementsByTagName("li");
  //   for (var i = 0; i < lis.length; i++) {
  //     lis[i].setAttribute("index", i);

  //     lis[i].onclick = function () {
  //       var index = this.getAttribute("index");
  //       console.log(index);

  //       for (var j = 0; j < lis.length; j++) {
  //         lis[j].className = "";
  //         lis[index].className = "active";
  //       }
  //     };
  //   }

  var lis = document.getElementsByTagName("li");
  for (var i = 0; i < lis.length; i++) {
    lis[i].setAttribute("index", i);

    lis[i].onclick = function () {
      var index = this.getAttribute("index");
      console.log(index);

      for (var j = 0; j < lis.length; j++) {
        lis[j].className = "";
        lis[index].className = "active";
      }
    };
  }

  var start = 0;
  setInterval(function () {
    start++;
    if (start >= lis.length) {
      start = 0;
    }

    lis[start].click();
  }, 1000);
```

### 06-REM适配

- 设计稿是1920px  

- PC端适配： 宽度在 1024~1920之间页面元素宽高自适应

  1. setRem.js 把屏幕分为 18等份（我的屏幕宽1440）

  2. cssrem 插件的基准值是  80px 

     插件-配置按钮---配置扩展设置--Root Font Size 里面 设置。 

     但是别忘记重启vscode软件保证生效

  3. 要把屏幕宽度约束在1024~1920之间有适配，实现代码：

```js
//setRem.js
function setRem() {
    var clientWidht = document.clientWidht || document.body.clientWidth;

    clientWidht = clientWidht > 1920 ? 1920 : clientWidht;
    clientWidht = clientWidht < 1024 ? 1024 : clientWidht;

    var rem = clientWidht / 18;
    var html = document.getElementsByTagName('html')[0];
    html.style.fontSize = rem + 'px';

}

window.onload = setRem;
window.onresize = setRem;
```

html结构：

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <link rel="stylesheet" href="./css/index.css" />
  </head>

  <body>
    <div class="viewport">
      <div class="column">
        <!--概览-->
        <div></div>
        <!--监控-->
        <div></div>
        <!--点位-->
        <div></div>
      </div>
      <div class="column">
        <!--地图-->
        <div></div>
        <!--用户-->
        <div></div>
      </div>
      <div class="column">
        <!--订单-->
        <div></div>
        <!--销售-->
        <div></div>
        <div>
          <!--渠道-->
          <div></div>
          <!--季度-->
          <div></div>
        </div>
        <!--排行-->
        <div></div>
      </div>
    </div>
  </body>
</html>
<script src="./js/setRem.js"></script>

```

- 效果图： 1920px *  1078px 
- body 设置背景图 ，行高1.15
- viewport 主体容器，限制最小宽度1024px，与最大宽度1920px，最小高度780px。
  - 需要居中显示
  - 使用logo.png做为背景图，在容器内显示
  - 内间距 70px 20px 0
- column 列容器，分三列，占比 3：4：3
  - 中间容器外间距  30px  15px 0

css样式：

```css
* {
  margin: 0;
  padding: 0;
}

body {
  background: url(../images/bg.jpg) no-repeat;
  background-size: cover;

}

h4,
h3,
ul {
  margin: 0;
  padding: 0;
  font-weight: normal;
}
ul {
  list-style: none;
}
a {
  text-decoration: none;
}

/* 主体容器 */
.viewport {
  min-width: 1024px;
  max-width: 1920px;
  min-height: 10rem;
  margin: 0 auto;
  padding: 1rem 0.25rem 0;
  box-sizing: border-box;
  background: url(../images/logo.png) no-repeat;
  background-size: contain;
  display: flex;
}

.viewport > .column {
  flex: 3;
  background-color: rgb(248, 187, 187);
}

/* 中间板板占四份  3:4:3的比例分配 */

.viewport > .column:nth-of-type(2) {
  flex: 4;
  background-color: skyblue;
  margin: 0.375rem 0.1875rem 0;
}

```